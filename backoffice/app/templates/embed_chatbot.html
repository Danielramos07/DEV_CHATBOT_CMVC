<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chatbot</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/chat.css') }}"
    />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #f4f6f9;
      }
      .chat-sidebar {
        position: relative;
        width: 100%;
        height: 100vh;
        right: 0;
        bottom: 0;
        border-radius: 0;
        box-shadow: none;
        display: flex;
      }
      .chat-toggle-btn,
      .chat-close-btn {
        display: none !important;
      }
      @media (max-width: 768px) {
        .chat-main {
          flex-direction: row;
        }
        .chat-avatar-column {
          width: 42%;
          min-width: 260px;
          border-right: 1px solid #e2e2e2;
          border-bottom: none;
          padding: 18px 20px 18px 24px;
        }
        #chatAvatarSuggestions {
          display: block;
        }
      }
    </style>
  </head>
  <body>
    <div class="chat-sidebar" id="chatSidebar">
      <div class="chat-sidebar-inner">
        <div class="chat-header">
          <button class="chat-close-btn" onclick="fecharChat()">&times;</button>
          <img
            src="{{ url_for('static', filename='images/chatbot/chatbot-icon.png') }}"
            alt="Chatbot"
            class="chat-header-avatar"
          />
          <div class="chat-header-info">
            <h3 id="chatHeaderNomeBot"></h3>
            <div id="chatFonteBadge"></div>
          </div>
        </div>

        <div class="chat-main">
          <div class="chat-avatar-column">
            <div class="chat-avatar-header-row">
              <button
                id="avatarToggleBtn"
                class="avatar-toggle-btn"
                type="button"
                onclick="toggleAvatarAtivo()"
              >
                Desligar avatar
              </button>
            </div>

            <div class="chat-avatar-panel" id="chatAvatarPanel">
              <div class="chat-avatar-inner">
                <video
                  class="chat-avatar-video"
                  autoplay
                  loop
                  style="display: none"
                ></video>
                <img
                  src="{{ url_for('static', filename='images/chatbot/chatbot-icon.png') }}"
                  alt="Assistente Virtual"
                  class="chat-avatar-image"
                />
              </div>
            </div>

            <div
              style="
                display: flex;
                gap: 10px;
                align-items: center;
                flex-wrap: nowrap;
              "
            >
              <button
                id="chatResetBtn"
                class="chat-reset-btn"
                type="button"
                onclick="reiniciarConversa()"
                style="flex: 1.35; white-space: nowrap; min-width: 140px"
              >
                Reiniciar
              </button>
              <button
                id="chatMuteBtn"
                class="chat-reset-btn"
                type="button"
                onclick="toggleAvatarSound()"
                style="flex: 1; white-space: nowrap; min-width: 110px"
                title="Ligar/desligar som do avatar"
              >
                Som
              </button>
            </div>

            <div class="chat-suggestions" id="chatAvatarSuggestions"></div>
          </div>

          <div class="chat-body" id="chatBody"></div>
        </div>

        <div class="chat-input">
          <input
            type="text"
            placeholder="Digite uma mensagem..."
            id="chatInput"
            onkeydown="if(event.key==='Enter') enviarPergunta()"
          />
          <button
            id="chatMicBtn"
            class="chat-mic-btn"
            type="button"
            onclick="toggleMic()"
            title="Usar o microfone"
          >
            <span class="mic-icon">Mic</span>
          </button>
          <button
            id="chatSendBtn"
            class="chat-send-btn"
            type="button"
            onclick="enviarPergunta()"
            title="Enviar"
          >
            Enviar
          </button>
        </div>
      </div>
    </div>

    <script>
      window.EMBED_MODE = true;
      window.EMBED_CHATBOT_ID = {{ chatbot_id }};
    </script>
    <script src="{{ url_for('static', filename='js/globals.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
    <script src="{{ url_for('static', filename='js/toggleChat.js') }}"></script>
    <script src="{{ url_for('static', filename='js/video-status.js') }}"></script>
  </body>
</html>
